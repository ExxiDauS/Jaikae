{% extends 'base.html' %}

{% block title %}
  Jaikae - Register Pet
{% endblock %}

{% block content %}
  <div class="container mx-auto px-4 py-8">
    <!-- Header -->
    <div class="text-center mb-8">
      <h1 class="text-5xl font-bold text-primary mb-4">üêæ Register a New Pet</h1>
      <p class="text-base-content/70 text-lg">Help your furry friend find their forever home</p>
    </div>

    <!-- Main Form -->
    <div class="max-w-4xl mx-auto">
      <div class="card bg-base-200 shadow-xl">
        <div class="card-body">
          <form method="post" enctype="multipart/form-data" class="space-y-8">
            {% csrf_token %}

            <!-- Pet Image Section -->
            <div class="divider divider-primary">
              <h2 class="text-2xl font-bold text-primary">üì∏ Pet Photo</h2>
            </div>

            <div class="form-control w-full">
              {{ image_form.pet_image.label_tag }}
              {{ image_form.pet_image }}
              {% if image_form.pet_image.errors %}
                <label class="label"><span class="label-text-alt text-red-600">{{ image_form.pet_image.errors.0 }}</span></label>
              {% endif %}

              <!-- Image Preview -->
              <div id="imagePreviewContainer" class="mt-4 hidden">
                <div class="card bg-base-100 shadow-md">
                  <figure>
                    <img id="imagePreview" src="" alt="Pet preview" class="h-72 w-full object-contain rounded-lg" />
                  </figure>
                </div>
              </div>
            </div>

            <!-- Pet Details Section -->
            <div class="divider divider-primary">
              <h2 class="text-2xl font-bold text-primary">üêï Pet Information</h2>
            </div>

            <!-- Basic Info Row -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <!-- Pet Name -->
              <div class="form-control flex flex-col w-full">
                {{ pet_form.name.label_tag }}
                {{ pet_form.name }}
                {% if pet_form.name.errors %}
                  <label class="label"><span class="label-text-alt text-red-600">{{ pet_form.name.errors.0 }}</span></label>
                {% endif %}
              </div>

              <!-- Species -->
              <div class="form-control flex flex-col w-full w-full">
                {{ pet_form.species.label_tag }}
                {{ pet_form.species }}
                {% if pet_form.species.errors %}
                  <label class="label"><span class="label-text-alt text-red-600">{{ pet_form.species.errors.0 }}</span></label>
                {% endif %}
              </div>
            </div>

            <!-- Breed and Color Row -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <!-- Breed -->
              <div class="form-control flex flex-col w-full">
                {{ pet_form.breed.label_tag }}
                {{ pet_form.breed }}
                {% if pet_form.breed.errors %}
                  <label class="label"><span class="label-text-alt text-red-600">{{ pet_form.breed.errors.0 }}</span></label>
                {% endif %}
              </div>

              <!-- Color -->
              <div class="form-control flex flex-col w-full">
                {{ pet_form.color.label_tag }}
                {{ pet_form.color }}
                {% if pet_form.color.errors %}
                  <label class="label"><span class="label-text-alt text-red-600">{{ pet_form.color.errors.0 }}</span></label>
                {% endif %}
              </div>
            </div>

            <!-- Physical Details Row -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <!-- Weight -->
              <div class="form-control flex flex-col w-full">
                {{ pet_form.weight.label_tag }}
                {{ pet_form.weight }}
                {% if pet_form.weight.errors %}
                  <label class="label"><span class="label-text-alt text-red-600">{{ pet_form.weight.errors.0 }}</span></label>
                {% endif %}
              </div>

              <!-- Gender -->
              <div class="form-control flex flex-col w-full">
                {{ pet_form.gender.label_tag }}
                {{ pet_form.gender }}
                {% if pet_form.gender.errors %}
                  <label class="label"><span class="label-text-alt text-red-600">{{ pet_form.gender.errors.0 }}</span></label>
                {% endif %}
              </div>
            </div>

            <!-- Status and Adoption Fee Row -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <!-- Adoption Fee -->
              <div class="form-control flex flex-col w-full">
                {{ pet_form.adoption_fee.label_tag }}
                {{ pet_form.adoption_fee }}
                {% if pet_form.adoption_fee.help_text %}
                  <label class="label"><span class="label-text-alt text-primary">{{ pet_form.adoption_fee.help_text }}</span></label>
                {% endif %}
                {% if pet_form.adoption_fee.errors %}
                  <label class="label"><span class="label-text-alt text-red-600">{{ pet_form.adoption_fee.errors.0 }}</span></label>
                {% endif %}
              </div>

              <!-- Date of Birth -->
              <div class="form-control flex flex-col w-full">
                {{ pet_form.dob.label_tag }}
                {{ pet_form.dob }}
                {% if pet_form.dob.errors %}
                  <label class="label"><span class="label-text-alt text-red-600">{{ pet_form.dob.errors.0 }}</span></label>
                {% endif %}
              </div>
            </div>

            <!-- Description -->
            <div class="form-control flex flex-col w-full">
              {{ pet_form.description.label_tag }}
              {{ pet_form.description }}
              {% if pet_form.description.help_text %}
                <label class="label"><span class="label-text-alt text-primary">{{ pet_form.description.help_text }}</span></label>
              {% endif %}
              {% if pet_form.description.errors %}
                <label class="label"><span class="label-text-alt text-red-600">{{ pet_form.description.errors.0 }}</span></label>
              {% endif %}
            </div>

            <!-- Vaccines -->
            <div class="form-control flex flex-col w-full">
              {{ pet_form.vaccines.label_tag }}
              <div class="grid grid-cols-2 gap-2 mt-2 w-full">
                {% for checkbox in pet_form.vaccines %}
                  <label class="flex items-center mr-4 mb-2">
                    {{ checkbox.tag }}
                    <span class="ml-2">{{ checkbox.choice_label }}</span>
                  </label>
                {% endfor %}
              </div>
              {% if pet_form.vaccines.help_text %}
                <label class="label"><span class="label-text-alt text-primary">{{ pet_form.vaccines.help_text }}</span></label>
              {% endif %}
              {% if pet_form.vaccines.errors %}
                <label class="label"><span class="label-text-alt text-red-600">{{ pet_form.vaccines.errors.0 }}</span></label>
              {% endif %}
            </div>

            <!-- Action Buttons -->
            <div class="flex flex-col sm:flex-row gap-4 justify-end pt-6">
              <a href="{% url 'pets' %}" class="btn btn-outline btn-lg w-full sm:w-auto">Cancel</a>
              <button type="submit" class="btn btn-primary btn-lg text-white w-full sm:w-auto flex items-center justify-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
                </svg>Register Pet
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Image Preview Script -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const imageInput = document.querySelector('input[type="file"]')
      const previewContainer = document.getElementById('imagePreviewContainer')
      const previewImage = document.getElementById('imagePreview')
    
      if (imageInput) {
        imageInput.addEventListener('change', function (e) {
          const file = e.target.files[0]
          if (file) {
            const reader = new FileReader()
            reader.onload = function (event) {
              previewImage.src = event.target.result
              previewContainer.classList.remove('hidden')
            }
            reader.readAsDataURL(file)
          } else {
            previewContainer.classList.add('hidden')
          }
        })
      }
    })
  </script>
{% endblock %}
